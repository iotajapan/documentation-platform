{"path":"docs/wallets/0.1/hub/how-to-guides/get-started-with-the-grpc-api","templateID":1,"sharedPropsHashes":{},"localProps":{"markdown":"# gRPC API 入門\n<!-- # Get started with the gRPC API -->\n\n**ハブは，任意の gRPC クライアントを使用して呼び出すことができるいくつかの gRPC メソッドを公開しています．これらの方法で，ハブデータベースおよび IOTA ノードとやり取りすることでユーザーの IOTA トークンを管理できます．このガイドでは，新しいデポジットアドレスを持つ新しいユーザーを作成するための gRPC API の基本について学習します．**\n<!-- **Hub exposes some gRPC methods that you can call using any gRPC client. These methods allow you to manage users' tokens by interfacing with the Hub database and an IOTA node. In this guide, you learn the basics of the gRPC API to create a new user with some new deposit addresses.** -->\n\n## 前提条件\n<!-- ## Prerequisites -->\n\nこのガイドを完了するには，次のものが必要です．\nTo complete this guide, you must have the following:\n\n- [ハブのインスタンス](../how-to-guides/install-hub.md)\n<!-- - An [instance of Hub](../how-to-guides/install-hub.md) -->\n- [Visual Studio Code](https://code.visualstudio.com/Download) などのコードエディター\n<!-- - A code editor such as [Visual Studio Code](https://code.visualstudio.com/Download) -->\n- コマンドラインインターフェースへのアクセス\n<!-- - Access to a command-line interface -->\n\n## 手順1. gRPC クライアントをセットアップする\n<!-- ## Step 1. Set up the gRPC client -->\n\nAPI 呼び出しを送信する前に，API 呼び出しを作成できる gRPC クライアントが必要です．\n<!-- Before you can send API calls, you need a gRPC client that can create them. -->\n\n1. npm をインストールします．\n  <!-- 1. Install npm -->\n\n    ```bash\n    sudo apt install -y npm\n    ```\n\n2. `grpcc` パッケージをインストールします．\n  <!-- 2. Install the `grpcc` package -->\n\n    ```bash\n    sudo npm install -g grpcc\n    ```\n\n3. `hub` ディレクトリに移動します．\n  <!-- 3. Change into the `hub` directory -->\n\n    ```bash\n    cd hub\n    ```\n\n4. gRPC クライアントを起動します．`localhost：50051` 引数を，ハブのセットアップ時に使用した `--listenAddress` コマンドラインオプションの値に置き換えます．\n  <!-- 4. Start the gRPC client. Replace the `localhost:50051` argument with the value of the `--listenAddress` command-line option that you used when you set up Hub. -->\n\n    ```bash\n    grpcc -i -a localhost:50051 -p proto/hub.proto\n    ```\n\n    :::info:\n    バイナリがインストールされていないというエラーメッセージが表示される場合は，`node_modules` ディレクトリを削除してから，`sudo npm install -g --unsafe-perm grpcc` コマンドで `grpcc` パッケージを再インストールします．\n    :::\n    <!-- :::info: -->\n    <!-- If you see an error message about a binary not being installed, try removing your `node_modules` directory, then reinstall the `grpcc` package with the following command: `sudo npm install -g --unsafe-perm grpcc`. -->\n    <!-- ::: -->\n\n    次のようなものが見えるはずです．\n    <!-- You should see something like the following: -->\n\n    ```bash\n    Connecting to hub.rpc.Hub on localhost:50051. Available globals:\n\n    client - the client connection to Hub\n        createUser (CreateUserRequest, callback) returns CreateUserReply\n        getBalance (GetBalanceRequest, callback) returns GetBalanceReply\n        getDepositAddress (GetDepositAddressRequest, callback) returns GetDepositAddressReply\n        userWithdraw (UserWithdrawRequest, callback) returns UserWithdrawReply\n        userWithdrawCancel (UserWithdrawCancelRequest, callback) returns UserWithdrawCancelReply\n        getUserHistory (GetUserHistoryRequest, callback) returns GetUserHistoryReply\n        processTransferBatch (ProcessTransferBatchRequest, callback) returns ProcessTransferBatchReply\n        balanceSubscription (BalanceSubscriptionRequest, callback) returns BalanceEvent\n        getStats (GetStatsRequest, callback) returns GetStatsReply\n        sweepSubscription (SweepSubscriptionRequest, callback) returns SweepEvent\n        getAddressInfo (GetAddressInfoRequest, callback) returns GetAddressInfoReply\n        sweepInfo (SweepInfoRequest, callback) returns SweepEvent\n        signBundle (SignBundleRequest, callback) returns SignBundleReply\n        sweepDetail (SweepDetailRequest, callback) returns SweepDetailReply\n\n    printReply - function to easily print a unary call reply (alias: pr)\n    streamReply - function to easily print stream call replies (alias: sr)\n    createMetadata - convert JS objects into grpc metadata instances (alias: cm)\n    printMetadata - function to easily print a unary call's metadata (alias: pm)\n\n    Hub@localhost:50051> (node:6023) DeprecationWarning: grpc.load: Use the @grpc/proto-loader module with grpc.loadPackageDefinition instead\n    ```\n\n    :::info:\n    これらのメソッドはすべて [gRPC API リファレンス](../references/grpc-api-reference.md)に文書化されています．\n    :::]\n    <!-- :::info: -->\n    <!-- These methods are all documented in the [gRPC API reference](../references/grpc-api-reference.md). -->\n    <!-- ::: -->\n\n## 手順2. ハブに IOTA トークンをデポジットする\n<!-- ## Step 2. Deposit IOTA tokens into Hub -->\n\ngRPC クライアントがある場合は，gRPC クライアントを使用して API 呼び出しをハブに送信し，ユーザーとそのデポジットを管理できます．\n<!-- When you have a gRPC client, you can use it to send API calls to Hub to manage users and their deposits. -->\n\n1. 新しいユーザーを作成します．\n  <!-- 1. Create a new user -->\n\n    ```bash\n    client.createUser({userId: \"Jake\"}, pr)\n    ```\n\n    :::info:\n    `createUser()` メソッドは `CreateUserRequest` オブジェクトを受け取ります．[API リファレンス](../references/grpc-api-reference.md#hub.rpc.CreateUserRequest)で `CreateUserRequest` オブジェクトを検索できます．\n\n    `pr` 引数は，結果をコンソールに出力するビルド済みのコールバック関数です．\n    :::\n    <!-- :::info: -->\n    <!-- You can see in the console from step 3 that the `createUser()` method takes a `CreateUserRequest` object. You can search for that object in the [API reference](../references/grpc-api-reference.md#hub.rpc.CreateUserRequest). -->\n    <!-- The `createUser()` method takes a `CreateUserRequest` object. You can search for that object in the [API reference](../references/grpc-api-reference.md#hub.rpc.CreateUserRequest). -->\n\n    <!-- The `pr` argument is a pre-built callback function that prints the result to the console. -->\n    <!-- ::: -->\n\n    これで，データベースに新しいユーザーができました．\n    <!-- Now, you have a new user in the database. -->\n\n    :::info:\n    このユーザーは，[`user_account` テーブルのクエリ](../how-to-guides/query-the-database.md)によってハブデータベースで確認できます．\n    :::\n    <!-- :::info: -->\n    <!-- You can see this user in the Hub database by [querying the `user_account` table](../how-to-guides/query-the-database.md). -->\n    <!-- ::: -->\n\n2. チェックサムを持つ新しいデポジットアドレスを作成します．\n  <!-- 2. Create a new deposit address with the checksum -->\n\n    ```bash\n    client.getDepositAddress({userId: \"Jake\", includeChecksum: true}, pr)\n    ```\n\n    :::info:\n    データベースでは，アドレスは常にチェックサムなしで保存されます．\n    :::\n    <!-- :::info: -->\n    <!-- In the database, addresses are always saved without the checksum. -->\n    <!-- ::: -->\n\n3. IOTA トークンをユーザーのデポジットアドレスの1つに送信します．\n  <!-- 3. Send some IOTA tokens to one of the user's deposit addresses -->\n\n    :::info:\n    [トリニティ](/docs/wallets/0.1/trinity/introduction/overview)は公式の IOTA ウォレットであり，IOTA トークンを簡単に送信できます．\n    :::\n    <!-- :::info: -->\n    <!-- [Trinity](/docs/wallets/0.1/trinity/introduction/overview) is the official IOTA wallet, which makes it easy to send IOTA tokens. -->\n    <!-- ::: -->\n\n4. ユーザーの残高と履歴を取得します．\n  <!-- 4. Get the balance and history for the user -->\n\n    ```bash\n    client.getBalance({userId: \"Jake\"}, pr)\n    ```\n\nIOTA トークンをデポジットアドレスに送信した場合，標準出力には次のように表示されます．\n<!-- If you sent IOTA tokens to the deposit address, the output should display something like the following: -->\n\n```shell\n10 i available for 'Jake'\nHistory:\nevents {\n\ttimestamp: 1540856214000\n\ttype: DEPOSIT\n\tamount: 10\n}\n```\n\n[thetangle.org](https://thetangle.org/) などのタングルエクスプローラーでデポジットアドレスの履歴を見ると，ハブがデポジットアドレスから別のアドレス（ハブの所有者のユーザーが取り出しを要求するまで資金が集められるアドレス）に資金を移動したことがわかります．このプロセスは[スウィープ](../concepts/sweeps.md)と呼ばれます．\n<!-- If you look at the deposit address history in a Tangle explorer such as [thetangle.org](https://thetangle.org/), you will see that Hub moved the funds away from the deposit address and into another address (Hub owner's address where funds are aggregated until a user requests a withdrawal). This process is called a [sweep](../concepts/sweeps.md). -->\n\n5. **Ctrl** + **C** を2回押して，gRPC クライアントを停止します．\n  <!-- 5. Press **Ctrl**+**C** twice to stop the gRPC client -->\n\n:::success:おめでとうございます:tada:\n新しいユーザーを正常に作成し，ハブが IOTA トークンのデポジットを処理する方法をテストしました．\n:::\n<!-- :::success:Congratulations :tada: -->\n<!-- You've successfully created a new user and tested how Hub handles deposits of IOTA tokens. -->\n<!-- ::: -->\n\n## 次のステップ\n<!-- ## Next steps -->\n\n[デモ取引所のセットアップ](../how-to-guides/create-a-demo-exchange.md)を行い，ハブの統合をテストする．\n<!-- [Set up a demo exchange](../how-to-guides/create-a-demo-exchange.md) to test an integration of Hub. -->\n\n[取引所にハブを統合する](../how-to-guides/integrate-hub.md)．\n<!-- [Integrate Hub into your exchange](../how-to-guides/integrate-hub.md). -->\n\n実稼働環境では，利用可能な [gRPC ライブラリ](https://grpc.io/about/)のいずれかからクライアントコードを生成することをお勧めします．\n<!-- For production environments, we recommend generating client code from one of the available [gRPC libraries](https://grpc.io/about/). -->\n","title":"gRPC API 入門 | ハウツーガイド | Hub | ウォレット"}}
