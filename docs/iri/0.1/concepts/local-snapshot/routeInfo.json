{"path":"docs/iri/0.1/concepts/local-snapshot","templateID":1,"sharedPropsHashes":{},"localProps":{"markdown":"# Local snapshot\n\n**A local snapshot is the process in which an IRI node records the state of its ledger in snapshot files. When an IRI node starts running, it must synchronize its ledger with its neighbors, starting from a particular milestone. Each version of the IRI has a hard-coded milestone that nodes can start from. To synchronize faster, an IRI node can choose to use local snapshot files.**\n\n:::info:\nLocal snapshots are available only in version 1.6.0 and later of the IRI.\n:::\n\n## Snapshot files\n\nSnapshot files store the state of an IRI node's ledger at regular intervals. \n\nIf an IRI node is [synchronized](../concepts/the-ledger.md#ledger-synchronization), it creates snapshot files at the milestone intervals that are defined in the [`LOCAL_SNAPSHOTS_INTERVAL_SYNCED`](../references/iri-configuration-options.md#local-snapshots-interval-synced) configuration option.\n\nIf an IRI node isn't synchronized, it creates snapshot files at the milestone intervals that are defined in the [`LOCAL_SNAPSHOTS_INTERVAL_UNSYNCED`](../references/iri-configuration-options.md#local-snapshots-interval-unsynced) configuration option.\n\n:::info:\nAt each interval, the snapshot file is overwritten.\n:::\n\nLocal snapshots result in the following snapshot files:\n* **snapshot.meta:** [Transaction data that the IRI uses to start synchronizing its ledger with neighbor IRI nodes](../references/data-in-the-snapshot-metadata-file.md)\n* **snapshot.state:** A list of all addresses that have a balance greater than 0 at the time of the local snapshot.\n\n:::info:\nThese files are located in the path of the [`LOCAL_SNAPSHOTS_BASE_PATH`](../references/iri-configuration-options.md#local-snapshots-base-path) configuration option.\n:::\n\nOn startup, IRI nodes can use the snapshot files as an entry point to synchronize their ledgers with their neighbors.\n\n## Example scenario of a local snapshot\n\n**Configuration parameter:**\n\n* `LOCAL_SNAPSHOTS_DEPTH` = 100\n* `LOCAL_SNAPSHOTS_INTERVAL_SYNCED` = 10\n\n**Current milestone index:**\n\n* 990, 100\n\nIn this scenario, the IRI node is synchronized. So, at milestone 990, 110, the node will do the following:\n\n* Take the previous 100 milestones and add them to the snapshot.meta file as [seen milestones](../references/data-in-the-snapshot-metadata-file.md#seen-milestone)\n* Find the solid transactions and add them as [solid entry points](../references/data-in-the-snapshot-metadata-file.md#solid-entry-point)\n* In the snapshot.state file, add a list of all addresses and their balances\n\nWhen the IRI node restarts, it can use the snapshot files as the entry point to [synchronize its ledger](../concepts/the-ledger.md#ledger-synchronization).\n\n## Transaction pruning\n\nDuring a local snapshot, an IRI node can prune transactions from its ledger if they were confirmed by an old milestone.\n\nAn old milestone is one that has an index greater than the combined value of the [`LOCAL_SNAPSHOTS_DEPTH`](../references/iri-configuration-options.md#local-snapshots-depth) and [`LOCAL_SNAPSHOTS_PRUNING_DELAY`](../references/iri-configuration-options.md#local-snapshots-pruning-delay) configuration options.\n\n## Example scenario of transaction pruning\n\n**Configuration parameters:**\n\n* `LOCAL_SNAPSHOTS_PRUNING_DELAY` = 50,000\n* `LOCAL_SNAPSHOTS_DEPTH` = 100\n\n**Current milestone index:**\n\n* 990, 100\n\nIn this scenario, the sum of `LOCAL_SNAPSHOTS_PRUNING_DELAY` + `LOCAL_SNAPSHOTS_DEPTH` is 50, 100. Therefore, an IRI node will prune transactions that were confirmed by any milestone with an index lower than 940, 000 (990, 100 - 50,100). As a result all transactions between milestones 940, 000 and 990, 100 will be kept in the ledger.\n\n\n\n\n","title":"Local snapshot | Concepts | IRI"}}
