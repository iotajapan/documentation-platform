{"path":"docs/client-libraries/0.1/how-to-guides/c/transfer-iota-tokens","templateID":1,"sharedPropsHashes":{},"localProps":{"markdown":"# Send a micropayment in C\n\n**In this guide, you send a micropayment of 1 IOTA by sending a [transfer bundle](/docs/getting-started/0.1/transactions/bundles) to a [node](/docs/getting-started/0.1/network/nodes).**\n\n## IOTA network\n\nIn this guide, we connect to a [node](/docs/getting-started/0.1/network/nodes) on the [Devnet](/docs/getting-started/0.1/network/iota-networks#devnet) with the following network settings:\n\n- **[Minimum weight magnitude](/docs/getting-started/0.1/network/minimum-weight-magnitude)**: 9\n\n- **[Depth](/docs/getting-started/0.1/transactions/depth)**: 3\n\nThese settings are defined in a `config.h` file, which we create in the [getting started guide](../../getting-started/c-quickstart.md).\n\n## Step 1. Get test IOTA tokens\n\nTo send test IOTA tokens on the Devnet, the nodes must have a record of a greater than 0 balance for one of the addresses that belongs to your seed. To get test IOTA tokens to use on the Devnet, you can use the Devnet faucet.\n\n1\\. Create a new seed and back it up\n\n--------------------\n### Linux\n```bash\ncat /dev/urandom |tr -dc A-Z9|head -c${1:-81}\n```\n---\n### macOS\n```bash\ncat /dev/urandom |LC_ALL=C tr -dc 'A-Z9' | fold -w 81 | head -n 1\n```\n---\n### Windows PowerShell\n```bash\n$b=[byte[]] (1..81);(new-object Security.Cryptography.RNGCryptoServiceProvider).GetBytes($b);-join($b|%{[char[]] (65..90+57..57)[$_%27]})\n```\n--------------------\n\n2\\. [Generate a new address for your seed](../c/generate-an-address.md)\n\n3\\. Copy and paste your address into the [Devnet faucet](https://faucet.devnet.iota.org), then wait for the tokens to be transferred to your address\n\n## Step 2. Create and send a transfer bundle\n\nTo transfer your test tokens from one address to another, you need to create and send a transfer bundle. This bundle needs an input transaction to withdraw the IOTA tokens from your address and an output transaction to deposit them into another address.\n\n1. Import the packages\n\n    ```cpp\n    #include \"cclient/api/core/core_api.h\"\n    #include \"cclient/api/extended/extended_api.h\"\n\n    #include \"common/trinary/tryte_ascii.h\"\n    #include \"utils/time.h\"\n    #include <inttypes.h>\n\n    #include \"iota_client_service/config.h\"\n    #include \"iota_client_service/client_service.h\"\n    ```\n\n2. Define your seed. Replace this seed with one that owns an address with test IOTA tokens\n\n    ```cpp\n    static tryte_t const *const MY_SEED =\n    (tryte_t *)\"HFYPTJZIVDJ9TQTQPIJXRXVJVOBOXAHZYZMVQBMFQYEAITJZKPHKUKERFQNAXNVTJRAHBGFJJIZTOTGJC\";\n    ```\n\n    :::info:\n    Because this bundle transfers IOTA tokens, the seed is used to sign it. Therefore, this seed's addresses must contain at least 1 IOTA token.\n    :::\n\n3. Define the address to which you want to send your IOTA token\n\n    ```cpp\n    static tryte_t const *const RECEIVER_ADDR =\n    (tryte_t *)\"ZLGVEQ9JUZZWCZXLWVNTHBDX9G9KZTJP9VEERIIFHY9SIQKYBVAHIMLHXPQVE9IXFDDXNHQINXJDRPFDX\";\n    ```\n\n4. Create a `transfers` array that specifies the amount of IOTA tokens you want to transfer and the address to send the tokens to\n\n    ```cpp\n    // Define an input transaction object\n    // that sends 1 i to the address\n    transfer_t tf = {};\n    // Convert the seed from trytes to trits\n    flex_trit_t seed[NUM_FLEX_TRITS_ADDRESS];\n    flex_trits_from_trytes(seed, NUM_TRITS_ADDRESS, MY_SEED, NUM_TRYTES_ADDRESS, NUM_TRYTES_ADDRESS);\n\n    // Convert the receiver's address from trytes to trits\n    flex_trits_from_trytes(tf.address, NUM_TRITS_ADDRESS, RECEIVER_ADDR, NUM_TRYTES_ADDRESS, NUM_TRYTES_ADDRESS);\n\n    // Convert the transaction tag from trytes to trits\n    flex_trits_from_trytes(tf.tag, NUM_TRITS_TAG, (const tryte_t *)\"CCLIENT99999999999999999999\", NUM_TRYTES_TAG,\n                            NUM_TRYTES_TAG);\n\n    // The amount of IOTA tokens to send to the receiver's address\n    tf.value = 1;\n\n    transfer_array_add(transfers, &tf);\n    ```\n\n5. To create a bundle from your `transfers` array, pass it to the [`iota_client_send_transfer()`](https://github.com/iotaledger/entangled/blob/develop/cclient/api/extended/send_transfer.h) method, which handles [tip selection](/docs/node-software/0.1/iri/concepts/tip-selection), [remote proof of work](/docs/getting-started/0.1/transactions/proof-of-work), and sending the bundle to the node\n\n    ```go\n    // Create a bundle from the transfers array and send it to the node\n    ret_code = iota_client_send_transfer(s, seed, SECURITY_LEVEL, TIP_SELECTION_DEPTH, MINIMUM_WEIGHT_MAGNITUDE, false, transfers, NULL, NULL, NULL, bundle);\n\n    printf(\"Sending 1 i to %s\\n\", RECEIVER_ADDR);\n    printf(\"Send transfer function %s\\n\", error_2_string(ret_code));\n    if (ret_code == RC_OK) {\n        flex_trit_t const *bundle_hash = bundle_transactions_bundle_hash(bundle);\n        printf(\"Bundle hash: \");\n        flex_trit_print(bundle_hash, NUM_TRITS_HASH);\n        printf(\"\\n\");\n    }\n\n    // Free the objects\n    bundle_transactions_free(&bundle);\n    transfer_message_free(&tf);\n    transfer_array_free(transfers);\n    ```\n\n    This method asks the node to check the balance of your seed's addresses. If your addresses have enough IOTA tokens to complete the transfer, the method creates input transactions to withdraw the full balance from enough of your addresses to fulfill the transfer. Then, the method adds those transactions to the transfer bundle and signs the bundle with the private keys of any withdrawn addresses.\n\n    :::info:\n    Your seed never leaves your device. The library generates addresses and sends them to the node.\n    :::\n\n    If the amount you want to transfer is less than the balance of your withdrawn addresses, the method creates another output transaction to transfer the remainder to an unspent address that belongs to your seed.\n\n    In the console, you should see information about the bundle that you just sent:\n\n    ```\n    Sending 1 i to RJBYLCIOUKWJVCUKZQZCPIKNBUOGRGVXHRTTE9ZFSCGTFRKELMJBDDAKEYYCLHLJDNSHQ9RTIUIDLMUOB\n    Send transfer function OK\n    Bundle hash: OLEIHCDXBBQNU9TAAKQGRPTJFAH9RDXIGYIKKGXVUHNLGJLARH9RGISYEHNNIWGWYNKDRUZELOGRAIILD\n    Sent IOTA tokens\n    ```\n\n:::success:Congratulations :tada:\nYou've just sent your first transfer bundle. Your transactions are attached to the Tangle and will be forwarded to the rest of the network. Now, you just need to wait until the transaction is confirmed for your balance to be updated.\n:::\n\n## Run the code\n\nThese code samples are hosted on [GitHub](https://github.com/JakeSCahill/c-iota-workshop).\n\nTo get started you need [Git](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git) installed on your device.\n\nYou also need a C development environment. If this is your first time using the C client library, complete our [getting started guide](../../getting-started/c-quickstart.md).\n\nIn the command-line, do the following:\n\n```bash\ngit clone https://github.com/iota-community/c-iota-workshop.git\ncd c-iota-workshop\nbazel run -c opt examples:send_tokens\n```\n\nIn the console, you should see information about the bundle that you just sent:\n\n```\nSending 1 i to RJBYLCIOUKWJVCUKZQZCPIKNBUOGRGVXHRTTE9ZFSCGTFRKELMJBDDAKEYYCLHLJDNSHQ9RTIUIDLMUOB\nSend transfer function OK\nBundle hash: OLEIHCDXBBQNU9TAAKQGRPTJFAH9RDXIGYIKKGXVUHNLGJLARH9RGISYEHNNIWGWYNKDRUZELOGRAIILD\nSent IOTA tokens\n```\n\n## Next steps\n\n[Check the balance of your address](../c/check-balance.md).\n\nIn this scenario, you wouldn't know in advance whether the address is spent during the time it takes to create and send your bundle.\n\nFor example, you are online shopping and the checkout has a QR code that gives you the option to pay in IOTA tokens. This QR code contains an address that is auto-populated in Trinity.\n\nDuring the time it takes you to complete the checkout and send your transfer bundle, the website owner withdraws IOTA tokens from the address in the QR code. Now that address is spent, and you have just sent IOTA tokens to it.\n\nTo help stop this from happening, we recommend using the [account module](../../account-module/introduction/overview.md) to create conditional deposit addresses that specify whether they are active or expired.\n\nAt the moment, the account module is available in the following languages:\n\n- Go\n- Java\n- JavaScript","title":"IOTA トークンを転送する | C | ハウツーガイド | CL ライブラリ"}}
