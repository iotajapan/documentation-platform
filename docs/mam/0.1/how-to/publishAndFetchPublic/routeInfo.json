{"path":"docs/mam/0.1/how-to/publishAndFetchPublic","templateID":1,"sharedPropsHashes":{},"localProps":{"markdown":"# 公開メッセージを公開する\n<!-- # Publishing public messages -->\n\n**この例を使用して、公開メッセージを公開できます。公開モードは、誰でもメッセージを表示できるMAMプライバシーモードです。**\n<!-- **Using this example you can publish a public message.  Public is the MAM privacy mode which allows messages to be viewed by anyone** -->\n\nMAMクライアントライブラリとASCIIからトライトへのコンバーター（`asciiToTrytes`）とトライトからASCIIへのコンバーター（`trytesToAscii`）をインポートします。\n<!-- Import the MAM client library and the ascii to tryte and tryte to ascii converters -->\n\n```js\nconst Mam = require('../lib/mam.client.js')\nconst { asciiToTrytes, trytesToAscii } = require('@iota/converter')\n```\n\nプライバシーモードをパブリックモードに設定します。プロバイダーを構成します。この例では、`Devnet`と呼ばれるIOTAテストネットワークを使用します。mamExplorerLinkを構成します。この例では、IOTA MAMエクスプローラーを使用します。\n<!-- Set the privacy mode to public.  Configure the provider.  This example uses the IOTA testbed, called \"Devnet\".  Configure the mamExplorerLink.  This example uses the IOTA MAM explorer. -->\n\n```js\nconst mode = 'public'\nconst provider = 'https://nodes.devnet.iota.org'\n\nconst mamExplorerLink = `https://mam-explorer.firebaseapp.com/?provider=${encodeURIComponent(provider)}&mode=${mode}&root=`\n```\n\nMAMにプロバイダーを使用するように指示します。\n<!-- Tell MAM to use the provider -->\n\n```js\n// Initialise MAM State\nlet mamState = Mam.init(provider)\n```\n\nASCIIデータをトライトに変換し、jsonに保存します。MAMメッセージを作成します。\n<!-- Convert the ascii data to trytes and store it in json.  Create your MAM message -->\n\n```js\n// Publish to tangle\nconst publish = async packet => {\n    // Create MAM Payload - STRING OF TRYTES\n    const trytes = asciiToTrytes(JSON.stringify(packet))\n    const message = Mam.create(mamState, trytes)\n\n    // Save new mamState\n    mamState = message.state\n```\n\nタングルにメッセージを送信します。このMAMストリームのMAMチャネルIDであるメッセージルートを取得します。\n<!-- Send your message to the Tangle. You will get the message root which is the MAM channel ID for this MAM stream -->\n\n```js\n    // Attach the payload\n    await Mam.attach(message.payload, message.address, 3, 9)\n\n    console.log('Published', packet, '\\n');\n    return message.root\n}\n```\n\n3つのメッセージを公開します。\n<!-- Publish three messages -->\n\n```js\nconst publishAll = async () => {\n  const root = await publish({\n    message: 'Message from Alice',\n    timestamp: (new Date()).toLocaleString()\n  })\n\n  await publish({\n    message: 'Message from Bob',\n    timestamp: (new Date()).toLocaleString()\n  })\n\n  await publish({\n    message: 'Message from Charlie',\n    timestamp: (new Date()).toLocaleString()\n  })\n\n  return root\n}\n```\n\n各メッセージを取得してデコードします。\n<!-- Fetch each message and decode it -->\n\n```js\n// Callback used to pass data out of the fetch\nconst logData = data => console.log('Fetched and parsed', JSON.parse(trytesToAscii(data)), '\\n')\n\npublishAll()\n  .then(async root => {\n\n    // Output asyncronously using \"logData\" callback function\n    await Mam.fetch(root, mode, null, logData)\n\n    // Output syncronously once fetch is completed\n    const result = await Mam.fetch(root, mode)\n    result.messages.forEach(message => console.log('Fetched and parsed', JSON.parse(trytesToAscii(message)), '\\n'))\n```\n\nMAMエクスプローラーでこれらのメッセージを表示するためのコマンドラインを出力します。\n<!-- Print the command line for viewing these messages in the MAM Explorer -->\n\n```js\n    console.log(`Verify with MAM Explorer:\\n${mamExplorerLink}${root}\\n`);\n  })\n```\n\n## アプトプットの例\n<!-- ## Example output -->\n\n3つのメッセージが表示されます。\n<!-- You should see three messages -->\n\n![screen capture verifying publishing and fetching](/assets/docs/mam/0.1/how-to/images/mamSimple.png)\n","title":"公開MAMストリームを公開する | ハウツーガイド | MAM"}}
