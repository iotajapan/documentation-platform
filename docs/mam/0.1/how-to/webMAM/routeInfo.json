{"path":"docs/mam/0.1/how-to/webMAM","templateID":1,"sharedPropsHashes":{},"localProps":{"markdown":"# Publishing to a webpage with MAM\n\n**You can build a webpage to publish and fetch MAM messages.**  \n\nPublish three messages\n\n```\nPublished: ALICE\nPublished: BOB\nPublished: CHARLIE\n```\n\nFetch and decode three messages\n\n```\nFetched and parsed ALICE\nFetched and parsed BOB\nFetched and parsed CHARLIE\n```\n\nUse the MAM Explorer to verify\n\n\n![screen capture showing these three MAM messages](/assets/docs/mam/0.1/how-to/images/webMAM.png)\n\n## Adding MAM in HTML\n\nUse the ```<html>``` tag to create your HTML page.  Set the character set to \"utf-8\".  In the ```<head>``` section, give your page a title.  Start the body of your webpage using the ```<body``` tag.  Set a division within the body using the ```<div>``` tag and give it an ID=\"output\" so your script knows where to send the output.\n\n```\n<html>\n<meta charset=\"utf-8\" />\n\n<head>\n    <title>MAM Example Publish and Fetch</title>\n</head>\n\n<body>\n    <div id=\"output\"></div>\n```\n\nTell the script where to find mam.web.min.js\n\n```\n    <script src=\"../lib/mam.web.min.js\"></script>\n```\n\nDefine the tryte alphabet.  Add functions to convert ascii characters to trytes and trytes to ascii\n\n```\n    <script>\n        const TRYTE_ALPHABET = '9ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\n        const asciiToTrytes = (input) => {\n            let trytes = '';\n            for (let i = 0; i < input.length; i++) {\n                var dec = input[i].charCodeAt(0);\n                trytes += TRYTE_ALPHABET[dec % 27];\n                trytes += TRYTE_ALPHABET[(dec - dec % 27) / 27];\n            }\n            return trytes;\n        };\n\n        const trytesToAscii = (trytes) => {\n            let ascii = '';\n            for (let i = 0; i < trytes.length; i += 2) {\n                ascii += String.fromCharCode(TRYTE_ALPHABET.indexOf(trytes[i]) + TRYTE_ALPHABET.indexOf(trytes[i + 1]) * 27);\n            }\n            return ascii;\n        };\n```\nConfigure the provider.  This example uses the IOTA testbed, called \"Devnet\".  Configure the mamExplorerLink.  This example uses the IOTA MAM explorer.  Set the HTML output to ```output```\n\n```\n        (async function () {\n            const mode = 'public'\n            const provider = 'https://nodes.devnet.iota.org'\n\n            const mamExplorerLink = `https://mam-explorer.firebaseapp.com/?provider=${encodeURIComponent(provider)}&mode=${mode}&root=`\n\n            const outputHtml = document.querySelector(\"#output\");\n\n```\nTell MAM to use the provider\n\n```\n            // Initialise MAM State\n            let mamState = Mam.init(provider)\n```\nFor each message, convert to trytes, then send it.  You will get the message root which is the MAM channel ID for this MAM stream\n\n```\n            // Publish to tangle\n            const publish = async packet => {\n                // Create MAM Payload - STRING OF TRYTES\n                const trytes = asciiToTrytes(JSON.stringify(packet))\n                const message = Mam.create(mamState, trytes)\n\n                // Save new mamState\n                mamState = message.state\n\n                // Attach the payload\n                await Mam.attach(message.payload, message.address, 3, 9)\n\n                outputHtml.innerHTML += `Published: ${packet}<br/>`;\n                return message.root\n            }\n```\nPublish three messages\n```\n            const publishAll = async () => {\n                const root = await publish('ALICE')\n\n                await publish('BOB')\n\n                await publish('CHARLIE')\n\n                return root\n            }\n\n```\nFetch three messages\n```\n            // Callback used to pass data out of the fetch\n            const logData = data => outputHtml.innerHTML += `Fetched and parsed ${JSON.parse(trytesToAscii(data))}<br/>`;\n\n            const root = await publishAll();\n\n            // Output asyncronously using \"logData\" callback function\n            await Mam.fetch(root, mode, null, logData)\n\n            // Output synchronously once fetch is completed\n            const result = await Mam.fetch(root, mode)\n            result.messages.forEach(message => {\n                outputHtml.innerHTML += `Fetched and parsed ${JSON.parse(trytesToAscii(message))}<br/>`\n            });\n\n```\nProvide a link so these transactions can be verified using the MAM Explorer\n```\n            outputHtml.innerHTML += `Verify with MAM Explorer:<br/><a target=\"_blank\" href=\"${mamExplorerLink}${root}\">${mamExplorerLink}${root}</a>`;\n        })();\n    </script>\n\n```\nEnd the script by close the body and the HTML tags\n\n```\n</body>\n\n</html>\n```\n","title":"Publish stream from browser | How-to Guides | MAM"}}
